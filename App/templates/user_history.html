{% extends "layout.html" %}
{% block title %}User History: {{ user.username }} - ShadowCipher{% endblock %}
{% block page %}User History: {{ user.username }} - ShadowCipher{% endblock %}

{{ super() }}

{% block content %}
<body class="content fill-space" style="background-color: #262627;">
  <nav class="nav-extended" style="margin-bottom:10px; background-color: #202020;">
    <div class="nav-wrapper row">
      <a href="#" style="font-size: 1.5em; margin-left: 10px" class="brand-logo left">{{ user.username }}'s Game History</a>
      <form class="right" action="/user_search" method="GET">
        <ul class="col">
          <li style="margin: 5px;">
            <input type="submit" value="Search">
          </li>
          <li style="margin: 5px;">
            <input type="search" name="username" id="username" placeholder="Search username" style="color: white">
          </li>
        </div>
      </form>
    </div>
  </nav>

  <div class="row" style="position: absolute; height:20px; top:0; z-index:10; width:100vw">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for message in messages %}
          <div class="blue lighten-5 col s10 offset-s1">
            <div class="row"> 
                <div class="col s11" style="font-weight: bold;text-align: center">
                  {{ message }}
                </div>
                <div class="col s1">
                  <a href="" style="font-size:1.5em" >&times;</a>
                </div>  
            </div>
          </div> 
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>

  <div class="row" style="margin: 0; padding:0; margin-top:-10px">
    <div class="col s12 m9 l8">
      <h1 style="color: white;">My Games ({{ num_games }})</h1>
    </div>
  </div>

  <div class="row">
    <section class="col s12 m9 l8" style="overflow-y:scroll; height: 70vh">
      {% if not user_games %}
      <p style="color: white">You haven't played any games yet!</p>
      {% else %}
      <div class="responsive-table">
        <table class="centered highlight striped" style="color: white">
          <thead style="width: 100%">
            <tr>
              <th>Date</th>
              <th>No. Digits</th>
              <th>Max Attempts</th>
              <th>No. Guesses</th>
              <th>Guesses</th>
            </tr>
          </thead>
          <tbody style="width: 100%">
            {% for game in user_games %}
            <tr>
              <td>{{ game.date.strftime('%B %d, %Y') }}</td>
              <td>{{ game.answer_length }}</td>
              <td>{{ game.max_attempts }}</td>
              <td>{{ game.num_guesses }}</td>
              <td><a class="waves-effect waves-light btn" href="/user_history/{{ user.id }}/{{ game.id }}#{{ game.date.strftime('%Y-%m-%d') }}">View Details</a></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endif %}
    </section>

    <section class="col s12 m3 l4" style="overflow-y:scroll; height: 70vh">
      {% if not selected_game %}
      <p style="color: white"> No games selected</p>
      {% else %}
      <ul class="collection" style="border: none">
        {% for labeled_guess in selected_game.labeled_guesses %}
        <li class="collection-item" style="background-color: inherit; border: none">
          <div style="display: flex; justify-content: center; margin-bottom: 10px;">
            {% for digit, label in labeled_guess %}
                {% if label == 'bull' %}
                    <input type="text" value="{{ digit }}" style="margin: 0 5px; flex: 1; border-radius: 5px; padding: 6px; color: white; font-size: 20px; text-align: center; background-color: #6ca965;" readonly>
                {% elif label == 'cow' %}
                    <input type="text" value="{{ digit }}" style="margin: 0 5px; flex: 1; border-radius: 5px; padding: 6px; color: white; font-size: 20px; text-align: center; background-color: #c8b653;" readonly>
                {% else %}
                    <input type="text" value="{{ digit }}" style="margin: 0 5px; flex: 1; border-radius: 5px; padding: 6px; color: white; font-size: 20px; text-align: center; background-color: #787c7f;" readonly>
                {% endif %}    
            {% endfor %}
        </div>
        </li>
        {% endfor %}
      </ul>
      {% endif %}
    </section>
  </div>
</body>
{% endblock %}
